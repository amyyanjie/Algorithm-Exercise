题目链接：LeetCode.193. 有效电话号码](https://leetcode-cn.com/problems/valid-phone-numbers/)

## 题目

给定一个包含电话号码列表（一行一个电话号码）的文本文件 `file.txt`，写一个单行 bash 脚本输出所有有效的电话号码。

你可以假设一个有效的电话号码必须满足以下两种格式： (xxx) xxx-xxxx 或 xxx-xxx-xxxx。（x 表示一个数字）

你也可以假设每行前后没有多余的空格字符。

**示例：**

假设 `file.txt` 内容如下：

```
987-123-4567
123 456 7890
(123) 456-7890
```

你的脚本应当输出下列有效的电话号码：

```
987-123-4567
(123) 456-7890
```

## 题解

### 一、正则表达式

#### 1.1 使用正则表达式

* 定位符：

  | 定位符 | 表达含义                                                     |
  | ------ | ------------------------------------------------------------ |
  | ^      | 字符串开始的位置                                             |
  | $      | 字符串结束的位置                                             |
  | \b     | 限定单词 (字) 的字符，常用来确定一个单词，可以结合两个‘\b’使用 |
  | \B     |                                                              |

* 限定符

  限定前面字符的出现次数。
  
  | 限定符 | 表达含义                    |
  | ------ | --------------------------- |
  | *      | 出现次数 >=0                |
  | +      | 出现次数 >=1                |
  | ？     | 出现次数 0 or 1, 等价 {0,1} |
  | {n}    | 出现次数 = n                |
  | {n,}   | 出现次数 >=n                |
  | {n, m} | n=< 出现次数 <= m           |
  
* 使用特殊字符，需要加上转义符 \

#### 1.2描述规律

* 表达 (xxx) xxx-xxxx

  注：后括号后面有个空格。

```
^\([0-9]{3}\) [0-9]{3}-[0-9]{4}$
```

* 表达 xxx-xxx-xxxx
```
^[0-9]{3}-[0-9]{3}-[0-9]{4}$
```

* 同时表示 xxx-xxx-xxxx 和 (xxx) xxx-xxxx

使用特殊字符 `()` 和 `|`。用 `()` 来标记一个表达式，使用 `|` 来指明两项之间的任意选择。

不同部分是xxx-和 (xxx) ，即`[0-9]{3}-`和`\([0-9]{3}\) `。即`[0-9]{3}-|(\([0-9]{3}\) )`。

```
^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$
```

### 二、使用grep或awk命令

* Linux grep 命令
grep 命令用于查找文件里符合条件的字符串。


语法：

```
grep [-abcEFGhHilLnqrsvVwxy][-A<显示行数>][-B<显示列数>][-C<显示列数>][-d<进行动作>][-e<范本样式>][-f<范本文件>][--help][范本样式][文件或目录...]
```

若不指定任何文件名称，或是所给予的文件名为 **-**，则 grep 指令会从标准输入设备读取数据。

* Linux awk 命令

AWK 是一种处理文本文件的语言，是一个强大的文本分析工具。

语法：

```
awk [选项参数] 'script' var=value file(s)
或
awk [选项参数] -f scriptfile var=value file(s)
```

这里匹配语句：

```
awk '{[pattern] action}' {filenames}   # 行匹配语句 awk '' 只能用单引号
```

条件pattern部分，支持的主要条件类型有：awk 保留字 BEGIN/END；关系型运算符；/正则/。

**awk正则表达式：如果想让 awk 识别字符串，则必须使用 "//" 包含**。

* gawk

gawk 是 Unix 中原始 awk 程序的 GNU 版本，强大之处在于可以写脚本来读取文本行的数据，然后处理并显示数据。

## 三、代码

* grep

```shell
grep -P '^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$' file.txt
```
 -P 可以让 grep 使用 perl 的正则表达式语法，因为 perl 的正则更加多元化，能实现更加复杂的场景。


* awk/gawk

```shell
awk '/^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$/' file.txt
```

或者

```shell
gawk '/^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$/' file.txt
```

如果想让 awk 识别字符串，则必须使用 "//" 包含。

